- @status_strings ||= { :yes => _('attending'), :no => _('not attending'), :maybe => _('uncommitted') }
- status = attendance_status(event, User.current_user)
%tr.vevent[event]
  %td.edit
    - if User.current_user.role.name == 'admin' or User.current_user == event.created_by
      = edit_link(event)
      %br
    - if User.current_user.role.name == 'admin'
      = delete_link(event)
  %td
    %span.uid&= ical_uid(event)
    = date_element(event)
  %td
    %h3.summary&= event.name
    %span.location.vcard
      = h(event.site) + tag(:br)
      %span.street-address= [h(event.street), h(event.street2)].join(tag(:br))
      %br
      :erb
        <span class="locality"><%= h(event.city) %></span>, <span class="region"><%= h event.state.code %></span>, <span class="country-name"><%= h event.state.country.code %></span>
    %br
    = distance_string(event, current_user)
    %span.map= map_link(event)
    %p= ical_link(event)
  %td
    %span.description&= event.description
  = render :partial => 'attendance', :locals => {:event => event}
  %td&= list_names(event.find_committed(:yes))
  %td&= list_names(event.find_committed(:no))
